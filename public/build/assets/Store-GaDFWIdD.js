import{r as s,c as X,u as G,a4 as J,b as P,B as y,j as e,ab as K,A as _,m as f,X as Q,C as M,I as U,a7 as Y,V as ee,L as E,a8 as ae}from"./main-BJAEKEeN.js";import{S as te}from"./shopping-bag-B6fD34td.js";function se(a,o,u){return typeof a=="string"?a=document.querySelectorAll(a):a instanceof Element&&(a=[a]),Array.from(a||[])}const re={some:0,all:1};function le(a,o,{root:u,margin:n,amount:i="some"}={}){const g=se(a),x=new WeakMap,c=h=>{h.forEach(d=>{const b=x.get(d.target);if(d.isIntersecting!==!!b)if(d.isIntersecting){const m=o(d);typeof m=="function"?x.set(d.target,m):r.unobserve(d.target)}else b&&(b(d),x.delete(d.target))})},r=new IntersectionObserver(c,{root:u,rootMargin:n,threshold:typeof i=="number"?i:re[i]});return g.forEach(h=>r.observe(h)),()=>r.disconnect()}function ne(a,{root:o,margin:u,amount:n,once:i=!1}={}){const[g,x]=s.useState(!1);return s.useEffect(()=>{if(!a.current||i&&g)return;const c=()=>(x(!0),i?void 0:()=>x(!1)),r={root:o&&o.current||void 0,margin:u,amount:n};return le(a.current,c,r)},[o,a,u,i,n]),g}/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=X("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]),O=a=>`₦${parseFloat(a).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})}`,oe=({product:a,handleAddToCart:o,customDelay:u=0})=>{var d,b;const[n,i]=s.useState(!1),g=ee.useRef(null),x=ne(g,{once:!0,amount:.2}),c=a.original_price&&parseFloat(a.original_price)>parseFloat(a.selling_price)?Math.round((parseFloat(a.original_price)-parseFloat(a.selling_price))/parseFloat(a.original_price)*100):0,r=a.quantity<=0||a.status===1,h=a.quantity>0&&a.quantity<=5;return e.jsxs(f.div,{ref:g,className:"mx-auto w-full max-w-xs sm:max-w-sm md:max-w-md bg-white dark:bg-gray-900 rounded-xl overflow-hidden shadow-lg dark:shadow-2xl group relative transform hover:scale-103 transition-transform duration-300 ease-out border border-gray-200 dark:border-transparent hover:border-blue-400 dark:hover:border-lime-600 flex flex-col",style:{maxWidth:"280px",maxHeight:"400px"},variants:{hidden:{opacity:0,scale:.9,y:30},visible:m=>({opacity:1,scale:1,y:0,transition:{delay:m*.08+u,duration:.5,ease:"easeOut"}})},initial:"hidden",animate:x?"visible":"hidden",custom:u,onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:[e.jsx(E,{to:`/collections/${((d=a.category)==null?void 0:d.link)||"default-category"}/${a.link}`,className:"block",children:e.jsxs("div",{className:"relative pt-[70%] overflow-hidden",children:[e.jsx(f.img,{src:a.image?`/${a.image}`:`https://placehold.co/300x210/D1D5DB/4B5563?text=${a.name.substring(0,Math.min(a.name.length,15))}`,alt:a.name,className:"absolute inset-0 w-full h-full object-cover opacity-100 transition-opacity duration-500 ease-out",initial:!1,animate:{opacity:n&&a.image2?0:1},onError:m=>{m.target.onerror=null,m.target.src=`https://placehold.co/300x210/D1D5DB/4B5563?text=${a.name.substring(0,Math.min(a.name.length,15))}`}}),e.jsx(_,{children:n&&a.image2&&e.jsx(f.img,{src:`/${a.image2}`,alt:`${a.name} - alternate view`,className:"absolute inset-0 w-full h-full object-cover",initial:{y:"100%"},animate:{y:"0%"},exit:{y:"100%"},transition:{duration:.4,ease:"easeOut"}})}),c>0&&e.jsxs("span",{className:"absolute top-3 right-3 bg-green-500 text-white text-xs font-bold px-2.5 py-0.5 rounded-full shadow-md dark:bg-green-600 dark:shadow-lg",children:["-",c,"%"]}),r?e.jsx("span",{className:"absolute top-3 left-3 bg-red-500 text-white text-xs font-bold px-2.5 py-0.5 rounded-full shadow-md dark:bg-red-600 dark:shadow-lg",children:"Out of Stock"}):h&&e.jsxs("span",{className:"absolute top-3 left-3 bg-orange-400 text-white text-xs font-bold px-2.5 py-0.5 rounded-full shadow-md dark:bg-orange-500 dark:shadow-lg",children:["Limited Stock (",a.quantity,")"]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent dark:from-black/50"})]})}),e.jsxs("div",{className:"p-3 flex flex-col flex-grow",children:[e.jsxs(E,{to:`/collections/${((b=a.category)==null?void 0:b.link)||"default-category"}/${a.link}`,className:"block",children:[e.jsx("h3",{className:"text-sm font-bold mb-1 text-gray-800 group-hover:text-blue-600 dark:text-white dark:group-hover:text-lime-400 transition-colors duration-300 line-clamp-2",children:a.name}),e.jsx("p",{className:"text-gray-500 mb-2 text-xs line-clamp-2 min-h-[2rem] dark:text-gray-400",children:a.description||"No description available."}),(a.average_rating!==void 0||a.rating!==void 0)&&e.jsxs("div",{className:"mb-2 flex items-center",children:[e.jsx(ae,{rating:parseFloat(a.average_rating||a.rating||0),iconSize:14})," ",a.num_reviews!==void 0&&e.jsxs("span",{className:"text-gray-500 text-xs ml-1 dark:text-gray-400",children:["(",a.num_reviews,")"]})]})]}),e.jsxs("div",{className:"mt-auto pt-2 border-t border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{children:[c>0&&e.jsx("p",{className:"text-xs text-gray-400 line-through dark:text-gray-500",children:O(a.original_price)}),e.jsxs("p",{className:`text-base font-bold ${h?"text-red-500 dark:text-red-400":"text-blue-600 dark:text-cyan-400"}`,children:[" ",O(a.selling_price)]})]}),e.jsx("button",{onClick:m=>{m.preventDefault(),o(a)},className:`p-2 rounded-lg font-semibold transition-all duration-300 flex items-center justify-center text-sm
                            ${r?"bg-gray-200 text-gray-400 cursor-not-allowed opacity-70 dark:bg-gray-700 dark:text-gray-400":"bg-blue-600 text-white hover:bg-blue-700 active:scale-95 shadow-md dark:bg-lime-600 dark:hover:bg-lime-700"}`,disabled:r,"aria-label":`Add ${a.name} to cart`,children:e.jsx(te,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-100/30 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none dark:from-lime-500/10"})]})]})},ce=[4,8,12,16,20],de=[{value:"alphaAsc",label:"Alphabetically, A-Z"},{value:"alphaDesc",label:"Alphabetically, Z-A"},{value:"featured",label:"Featured"},{value:"popular",label:"Popular"},{value:"priceAsc",label:"Price, low to high"},{value:"priceDesc",label:"Price, high to low"},{value:"ratingDesc",label:"Average Rating, high to low"},{value:"dateAsc",label:"Date, old to new"},{value:"dateDesc",label:"Date, new to old"}],me=()=>{G();const{addToCart:a}=J(),[o,u]=s.useState("All"),[n,i]=s.useState(0),[g,x]=s.useState(5e4),[c,r]=s.useState(1),[h,d]=s.useState(8),[b,m]=s.useState("dateDesc"),[$,L]=s.useState([]),[S,v]=s.useState([]),[R,C]=s.useState(!0),[w,k]=s.useState(1),[F,j]=s.useState(!1),q=t=>{if(t.quantity<=0||t.status===1){y.error("This product is currently out of stock or unavailable.");return}a(t,1),y.success(`${t.name} added to cart!`)};s.useEffect(()=>{document.title="Shop | First Digits",(async()=>{var l;try{const p=await P.get("/api/getCategory");p.data.status===200?L([{name:"All",link:"all"},...p.data.category]):y.error("Failed to fetch categories.");const N=await P.get("/api/allProducts");let D=0;if(N.data.status===200&&N.data.products.length>0){const H=N.data.products.map(Z=>parseFloat(Z.selling_price||0));D=Math.max(...H)}const W=Math.ceil((D+1e3)/1e3)*1e3,I=Math.max(W,5e4);x(I),i(I)}catch(p){console.error("Error fetching initial data (categories/max price):",((l=p.response)==null?void 0:l.data)||p.message),y.error("Network error fetching initial data."),x(5e4),i(5e4)}})()},[]);const A=s.useCallback(async()=>{var t;C(!0);try{const l=await P.get("/api/getProducts",{params:{category:o==="All"?null:o,min_price:0,max_price:n,sort:b,itemsPerPage:h,page:c}});l.data.status===200?(v(l.data.products.data),k(l.data.products.last_page)):l.data.status===404?(v([]),k(1),y.info(l.data.message||"No products found for this selection.")):(v([]),k(1),y.error(l.data.message||"An error occurred while fetching products."))}catch(l){console.error("Error fetching products:",((t=l.response)==null?void 0:t.data)||l.message),v([]),k(1),y.error("Failed to fetch products. Please try again.")}finally{C(!1)}},[o,n,b,h,c]);s.useEffect(()=>{(g>0||n>0)&&A()},[A,g]);const B=t=>{u(t.name),r(1),j(!1)},z=t=>{const l=parseInt(t.target.value,10);i(l),r(1)},T=t=>{m(t.target.value),r(1)},V=t=>{d(parseInt(t.target.value,10)),r(1)};return R?e.jsx(K,{}):e.jsxs("div",{className:"min-h-screen bg-gray-50 text-gray-800 pt-28 px-4 sm:px-6 lg:px-8 flex flex-col lg:flex-row gap-8 dark:bg-gray-950 dark:text-gray-200",children:[e.jsxs("button",{className:`lg:hidden fixed bottom-6 right-6 z-40
                        bg-gradient-to-r from-blue-500 to-purple-600 text-white
                        dark:from-blue-600 dark:to-indigo-700
                        p-4 rounded-full shadow-lg flex items-center justify-center space-x-2 transition-all hover:scale-105`,onClick:()=>j(!0),"aria-label":"Open Filters",children:[e.jsx(ie,{className:"w-6 h-6"}),e.jsx("span",{children:"Filters"})]}),e.jsx(_,{children:(F||window.innerWidth>=1024)&&e.jsxs(f.div,{initial:window.innerWidth<1024?{x:"-100%"}:{},animate:window.innerWidth<1024?{x:0}:{},exit:window.innerWidth<1024?{x:"-100%"}:{},transition:{duration:.3,ease:"easeInOut"},className:`fixed lg:static top-0 left-0 h-full w-72 lg:w-1/4
                                 bg-gray-100 dark:bg-gray-900 z-50 lg:z-auto p-6
                                 shadow-xl lg:shadow-none flex flex-col ${F?"flex":"hidden lg:flex"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 lg:hidden",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:"Filters"}),e.jsx("button",{onClick:()=>j(!1),className:`text-gray-600 hover:text-gray-900 transition-colors p-2 rounded-full hover:bg-gray-200
                                        dark:text-gray-400 dark:hover:text-white dark:hover:bg-gray-700`,"aria-label":"Close Filters",children:e.jsx(Q,{className:"w-7 h-7"})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4 text-blue-600 dark:text-cyan-400",children:"Categories"}),e.jsx("ul",{className:"space-y-3 text-lg",children:$.map(t=>e.jsx(f.li,{className:`cursor-pointer px-4 py-2 rounded-lg transition-all duration-200
                                                ${o===t.name?"bg-blue-600 text-white font-semibold shadow-md dark:bg-blue-700":"text-gray-700 hover:bg-gray-200 hover:text-blue-700 dark:text-gray-300 dark:hover:bg-gray-800 dark:hover:text-lime-400"}`,onClick:()=>B(t),whileTap:{scale:.98},children:t.name},t.name))})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4 text-blue-600 dark:text-cyan-400",children:"Max Price"}),e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"₦0"}),e.jsx("input",{type:"range",min:"0",max:g,value:n,onChange:z,className:`w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer accent-blue-600
                                            dark:bg-gray-700`}),e.jsxs("span",{className:"text-700 dark:text-gray-300",children:["₦",n.toLocaleString()]})]}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Showing products up to ₦",n.toLocaleString(),"."]})]})]})}),e.jsxs("div",{className:"flex-1 lg:ml-8",children:[" ",e.jsx("h2",{className:`text-4xl font-extrabold text-center lg:text-left mb-8
                               text-gray-800 bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-purple-700
                               dark:text-white dark:from-blue-400 dark:to-purple-600`,children:"Our Products"}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-8 space-y-4 sm:space-y-0 sm:space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 w-full sm:w-auto",children:[e.jsx("label",{htmlFor:"sort",className:"text-lg font-medium text-gray-700 dark:text-gray-300",children:"Sort by:"}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("select",{id:"sort",value:b,onChange:T,className:`block w-full px-4 py-2 pr-10
                                        text-gray-700 bg-gray-100 border border-gray-300 rounded-lg shadow-sm
                                        focus:outline-none focus:ring-2 focus:ring-blue-500 appearance-none transition-colors duration-200 cursor-pointer
                                        dark:text-gray-200 dark:bg-gray-800 dark:border-gray-700 dark:focus:ring-blue-600`,children:de.map(t=>e.jsx("option",{value:t.value,className:"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-200",children:t.label},t.value))}),e.jsx(M,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400 pointer-events-none"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 w-full sm:w-auto",children:[e.jsx("label",{htmlFor:"itemsPerPage",className:"text-lg font-medium text-gray-700 dark:text-gray-300",children:"Show:"}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("select",{id:"itemsPerPage",value:h,onChange:V,className:`block w-full px-4 py-2 pr-10
                                        text-gray-700 bg-gray-100 border border-gray-300 rounded-lg shadow-sm
                                        focus:outline-none focus:ring-2 focus:ring-blue-500 appearance-none transition-colors duration-200 cursor-pointer
                                        dark:text-gray-200 dark:bg-gray-800 dark:border-gray-700 dark:focus:ring-blue-600`,children:ce.map(t=>e.jsx("option",{value:t,className:"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-200",children:t},t))}),e.jsx(M,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400 pointer-events-none"})]})]})]}),e.jsx(f.div,{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-8",initial:"hidden",animate:"visible",variants:{visible:{transition:{staggerChildren:.1}}},children:S.length>0?S.map((t,l)=>e.jsx(oe,{product:t,handleAddToCart:q,customDelay:l*.05},t.id)):e.jsx(f.p,{initial:{opacity:0},animate:{opacity:1},className:"col-span-full text-center text-gray-500 text-xl py-10",children:"No products found matching your criteria."})}),e.jsxs("div",{className:"mt-12 flex justify-center items-center space-x-4",children:[e.jsxs("button",{className:`px-5 py-2 rounded-lg shadow-md transition-all duration-200 flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed
                                bg-gray-200 text-gray-700 hover:bg-gray-300
                                dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700`,onClick:()=>r(t=>Math.max(t-1,1)),disabled:c===1,children:[e.jsx(U,{className:"w-5 h-5"}),e.jsx("span",{children:"Previous"})]}),e.jsxs("span",{className:"text-lg font-medium text-gray-700 dark:text-gray-300",children:["Page ",c," of ",w]}),e.jsxs("button",{className:`px-5 py-2 rounded-lg shadow-md transition-all duration-200 flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed
                                bg-gray-200 text-gray-700 hover:bg-gray-300
                                dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700`,onClick:()=>r(t=>Math.min(t+1,w)),disabled:c===w,children:[e.jsx("span",{children:"Next"}),e.jsx(Y,{className:"w-5 h-5"})]})]})]})]})};export{me as default};
