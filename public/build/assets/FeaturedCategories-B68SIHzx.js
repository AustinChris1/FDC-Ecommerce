import{r as o,j as e,m as s,K as k,L as A,Q as P,b as h,B as p}from"./main-COYDbKvt.js";import{u as T}from"./index-DqzhowAm.js";import{S as U}from"./StarRating-qgcy1Df5.js";const G=()=>{const[d,S]=o.useState("All"),[u,R]=o.useState([]),[v,I]=o.useState([]),[m,b]=o.useState(!0),{ref:L,inView:i}=T({triggerOnce:!0,threshold:.05}),[f,y]=o.useState(1),g=8;o.useEffect(()=>{(async()=>{b(!0);try{const a=await h.get("/api/getCategory");a.data.status===200?R([{id:"All",name:"All",link:"/collections"},...a.data.category]):(p.error("Unable to fetch categories"),console.error("Backend error fetching categories:",a.data.message));const r=await h.get("/api/allProducts");if(r.data.status===200){const B=r.data.products.map(async n=>{let _=0,c=0;try{const l=await h.get(`/api/products/${n.id}/reviews`);l.data.status===200&&Array.isArray(l.data.reviews)&&(c=l.data.reviews.length,c>0&&(_=(l.data.reviews.reduce((M,D)=>M+parseFloat(D.rating),0)/c).toFixed(1)))}catch(l){console.warn(`Could not fetch reviews for product ${n.id}:`,l)}const z=n.original_price;return{...n,rating:parseFloat(_),num_reviews:c,original_price:z}}),O=await Promise.all(B);I(O)}else p.error("Unable to fetch products"),console.error("Backend error fetching products:",r.data.message)}catch(a){console.error("Network or server error during data fetch:",a),p.error("Failed to load data.")}finally{b(!1)}})()},[]);const j=d==="All"?v:v.filter(t=>t.category_id===d),w=Math.ceil(j.length/g),N=(f-1)*g,C=j.slice(N,N+g),$=t=>{var a;y(t),(a=document.getElementById("product-grid-section"))==null||a.scrollIntoView({behavior:"smooth",block:"start"})},F={hidden:{opacity:0,y:50},visible:{opacity:1,y:0,transition:{duration:.8,ease:"easeOut"}}},E={hidden:{opacity:0,scale:.9,y:50},visible:t=>({opacity:1,scale:1,y:0,transition:{delay:t*.15,duration:.6,ease:"easeOut"}})},V={hidden:{opacity:0,scale:.95,y:30},visible:t=>({opacity:1,scale:1,y:0,transition:{delay:t*.1,duration:.5,ease:"easeOut"}})};return e.jsxs("section",{ref:L,className:"py-16 md:py-24 bg-gray-950 text-white relative overflow-hidden",style:{backgroundImage:`radial-gradient(at 20% 0%, rgba(20,20,50,0.4) 0%, transparent 50%),
                                 radial-gradient(at 80% 100%, rgba(50,20,20,0.4) 0%, transparent 50%)`,backgroundBlendMode:"overlay"},children:[e.jsxs(s.div,{className:"absolute inset-0 pointer-events-none z-0",initial:{opacity:0},animate:{opacity:i?1:0},transition:{duration:1.5,delay:.5},children:[e.jsx("div",{className:"absolute -top-20 -left-20 w-64 h-64 bg-blue-500/10 rounded-full blur-3xl opacity-30"}),e.jsx("div",{className:"absolute -bottom-20 -right-20 w-64 h-64 bg-purple-500/10 rounded-full blur-3xl opacity-30"})]}),e.jsxs("div",{className:"container mx-auto px-4 relative z-10",children:[e.jsxs(s.div,{className:"text-center mb-12 md:mb-16",variants:F,initial:"hidden",animate:i?"visible":"hidden",children:[e.jsxs("h2",{className:"text-4xl sm:text-5xl lg:text-6xl font-extrabold mb-4 drop-shadow-lg leading-tight",children:["Explore Our ",e.jsx("span",{className:"text-cyan-400",children:"Top Categories"})]}),e.jsx("p",{className:"text-lg md:text-xl text-gray-300 max-w-2xl mx-auto",children:"Find the perfect tech for your needs from our expertly curated selections."})]}),m?e.jsxs("div",{className:"text-center py-20 flex flex-col items-center justify-center",children:[e.jsx(k,{className:"w-12 h-12 animate-spin text-cyan-400 mb-4"}),e.jsx("p",{className:"text-xl text-gray-400",children:"Loading categories..."})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 mb-20",children:u.filter(t=>t.id!=="All").slice(0,6).map((t,a)=>e.jsx(s.div,{className:"bg-gray-800 rounded-xl overflow-hidden shadow-2xl group relative cursor-pointer transform hover:scale-103 transition-transform duration-300 ease-out border border-transparent hover:border-blue-600",variants:E,initial:"hidden",animate:i?"visible":"hidden",custom:a,children:e.jsxs(A,{to:`/collections/${t.link||"default-category"}`,children:[e.jsxs("div",{className:"relative pt-[70%] overflow-hidden",children:[" ",e.jsx("img",{src:t.image||"https://placehold.co/400x280/e0e0e0/555555?text=Category+Image",alt:t.name,className:"absolute inset-0 w-full h-full object-cover group-hover:scale-105 transition-transform duration-500 ease-out opacity-80 group-hover:opacity-100"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"})]}),e.jsxs("div",{className:"p-6 text-left",children:[e.jsx("h3",{className:"text-2xl font-bold mb-2 text-white group-hover:text-cyan-400 transition-colors duration-300",children:t.name}),e.jsxs("div",{className:"inline-flex items-center text-blue-400 hover:text-blue-200 transition-colors duration-300 font-semibold group",children:["Shop Now",e.jsx(P,{className:"w-5 h-5 ml-2 transform group-hover:translate-x-1 transition-transform duration-300"})]})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/10 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"})]})},t.id))}),e.jsxs("div",{id:"product-grid-section",className:"mt-20",children:[e.jsxs(s.div,{className:"text-center mb-12 md:mb-16",variants:F,initial:"hidden",animate:i?"visible":"hidden",children:[e.jsxs("h2",{className:"text-4xl sm:text-5xl lg:text-6xl font-extrabold mb-4 drop-shadow-lg leading-tight",children:["Our Latest ",e.jsx("span",{className:"text-lime-400",children:"Products"})]}),e.jsx("p",{className:"text-lg md:text-xl text-gray-300 max-w-2xl mx-auto",children:"Browse our extensive catalog of cutting-edge technology."})]}),e.jsx(s.div,{className:"flex flex-wrap justify-center gap-4 mb-12",initial:"hidden",animate:i?"visible":"hidden",variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{staggerChildren:.1,delayChildren:.2}}},children:u.map(t=>e.jsx(s.button,{onClick:()=>{S(t.id),y(1)},className:`px-6 py-2 rounded-full font-semibold transition-all duration-300 transform hover:scale-105 shadow-md
                                    ${d===t.id?"bg-blue-600 text-white shadow-blue-500/50":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,variants:{hidden:{opacity:0,scale:.8},visible:{opacity:1,scale:1}},children:t.name},t.id))}),m?e.jsxs("div",{className:"text-center py-20 flex flex-col items-center justify-center",children:[e.jsx(k,{className:"w-12 h-12 animate-spin text-lime-400 mb-4"}),e.jsx("p",{className:"text-xl text-gray-400",children:"Fetching products..."})]}):e.jsx(e.Fragment,{children:C.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8",children:C.map((t,a)=>{var r;return e.jsx(s.div,{className:"bg-gray-800 rounded-xl overflow-hidden shadow-2xl group relative cursor-pointer transform hover:scale-103 transition-transform duration-300 ease-out border border-transparent hover:border-lime-600",variants:V,initial:"hidden",animate:i?"visible":"hidden",custom:a,children:e.jsxs(A,{to:`/collections/${((r=t.category)==null?void 0:r.link)||"default-category"}/${t.link}`,children:[e.jsxs("div",{className:"relative pt-[85%] overflow-hidden",children:[e.jsx("img",{src:t.image||"https://placehold.co/400x340/374151/9CA3AF?text=Product+Image",alt:t.name,className:"absolute inset-0 w-full h-full object-cover group-hover:scale-105 transition-transform duration-500 ease-out opacity-80 group-hover:opacity-100",onError:x=>{x.target.onerror=null,x.target.src=`https://placehold.co/400x340/374151/9CA3AF?text=${t.name.substring(0,3)}`}}),t.original_price&&parseFloat(t.original_price)>parseFloat(t.selling_price)&&e.jsxs("span",{className:"absolute top-3 right-3 bg-green-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg",children:["-",Math.round((parseFloat(t.original_price)-parseFloat(t.selling_price))/parseFloat(t.original_price)*100),"%"]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"})]}),e.jsxs("div",{className:"p-4 text-left flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold mb-2 text-white group-hover:text-lime-400 transition-colors duration-300 line-clamp-2",children:t.name}),e.jsxs("p",{className:"text-gray-400 mb-3 text-sm line-clamp-2 min-h-[2.5rem]",children:[" ",t.description||"No description available."]}),t.rating!==void 0&&t.num_reviews!==void 0&&e.jsx("div",{className:"mb-3",children:e.jsx(U,{rating:parseFloat(t.rating),iconSize:20})})]}),e.jsxs("div",{className:"flex flex-col gap-2 mt-4",children:[t.original_price&&parseFloat(t.original_price)>parseFloat(t.selling_price)&&e.jsxs("p",{className:"text-sm text-gray-500 line-through flex items-center",children:["₦",parseFloat(t.original_price).toLocaleString()]}),e.jsxs("p",{className:"text-2xl font-bold text-cyan-400 flex items-center",children:["₦",parseFloat(t.selling_price).toLocaleString()]}),e.jsxs("div",{className:"inline-flex items-center text-blue-400 hover:text-blue-200 transition-colors duration-300 font-semibold group",children:["Shop Now",e.jsx(P,{className:"w-5 h-5 ml-2 transform group-hover:translate-x-1 transition-transform duration-300"})]})]})]})]})},t.id)})}):e.jsx("div",{className:"text-center py-20",children:e.jsx("p",{className:"text-2xl text-gray-400",children:"No products found in this category."})})}),w>1&&!m&&e.jsx(s.div,{className:"flex justify-center items-center gap-4 mt-16",initial:"hidden",animate:i?"visible":"hidden",variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{staggerChildren:.1,delayChildren:.2}}},children:[...Array(w)].map((t,a)=>e.jsx(s.button,{onClick:()=>$(a+1),className:`w-10 h-10 rounded-full font-semibold transition-all duration-300 transform hover:scale-110
                                        ${f===a+1?"bg-blue-600 text-white shadow-lg":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,variants:{hidden:{opacity:0,scale:.8},visible:{opacity:1,scale:1}},children:a+1},a))})]})]})]})};export{G as default};
